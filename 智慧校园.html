<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=, initial-scale=1.0">
    <title>校园一日游</title>
    <!-- 1. 新建容器，存放地图 -->
    <style>
      html,
      body,
      #container{
          width: 100%;
          height: 100%;
      }
      #input-card{
          position: fixed;
          background-color: rgba(82, 91, 103, 0.493);
          /*max-height: 20%; */
          overflow-y: auto;
          top: 10px;
          right: 10px;
          width: 150px;
          height:150px;
      }
      #input-card .btn{
          margin-right: 1.2rem;
          width: 5rem;

      }

   </style>
<script type="text/javascript">
    window._AMapSecurityConfig = {
      securityJsCode: "f850ebd08379738ec26ec51e1329a34c",
    };
  </script>
  <script src="https://webapi.amap.com/loader.js"></script>
<script src="https://webapi.amap.com/maps?v=2.0&key=6d58b5b01a9a0e6c5d87074f3591d83c&plugin=AMap.Driving,AMap.MoveAnimation"></script>
</head>
<body>
  <div id="container"></div>
  <div id="input-card">
    <h4>轨迹动画<h4>
<div class="input-item">       
      <button class="btn"  onclick="startAnimation()">开始动画</button>
          
  </div>
</div>  
    <script>
      
          var map = new AMap.Map("container", {
          center:[102.75564194, 25.05765007],
          viewMode:'2D',
          zoom:15,
        });

          marker = new AMap.Marker({
            map: map,
            position: [102.75261992, 25.05777691],
            icon:new AMap.Icon({image:'迈凯伦.jpg',imageSize:[70,70]}),
            offset: new AMap.Pixel(0,0),
        });

        var lineArr =[];
        AMap.plugin(["AMap.Driving"], function () {
        var driving = new AMap.Driving({
          map:map,
          policy:0, 
        });
        var startLngLat = [102.75261992, 25.05777691]; 
        var endLngLat = [102.76223078, 25.06196161]; 
        var opts ={waypoints: [[102.75887534, 25.06041511],
        [102.75768310, 25.06142829],[102.75917441, 25.06202600]],} //途径点


      const position = new AMap.LngLat(102.75768310, 25.06142829); //Marker 经纬度
      const icon= new AMap.Icon({image:'图书馆.jpg',imageSize:[70,70]})
      const marker = new AMap.Marker({
      position: position,
      icon:icon
});
   map.add(marker)
  var text =new AMap.Text({
  position:new AMap.LngLat(102.75768310, 25.06142829),
  anchor:'top-right',
  text: '图书馆北馆',
  style:{'background-color':'pink'},
});
map.add(text);

const position1 = new AMap.LngLat(102.75917441, 25.06202600); //Marker 经纬度
    const icon1= new AMap.Icon({image:'松苑餐厅.jpg',imageSize:[60,60]});
    const marker1= new AMap.Marker({
    position: position1,
    icon:icon1
});
map.add(marker1)
var text =new AMap.Text({
  position:new AMap.LngLat(102.75917441, 25.06202600),
  anchor:'top-right',
  text: '松苑餐厅',
  style:{'background-color':'green'},
});
map.add(text);

const position2 = new AMap.LngLat(102.76223078, 25.06196161); //Marker 经纬度
    const icon2= new AMap.Icon({image:'羽毛球.JPG',imageSize:[70,70]});
    const marker2= new AMap.Marker({
    position: position2,
    icon:icon2
});
map.add(marker2)
var text =new AMap.Text({
  position:new AMap.LngLat(102.76222069, 25.06196160),
  anchor:'top-right',
  text: '羽毛球馆',
  style:{'background-color':'white'},
});
map.add(text);


const position3 = new AMap.LngLat(102.75887534, 25.06041511); //Marker 经纬度
    const icon3= new AMap.Icon({image:'至真楼.JPG',imageSize:[70,70]});
    const marker3= new AMap.Marker({
    position: position3,
    icon:icon3
});
map.add(marker3)
var text =new AMap.Text({
  position:new AMap.LngLat(102.75887534, 25.06041511),
  anchor:'top-right',
  text: '至真楼',
  style:{'background-color':'grey'},
});
map.add(text);


        driving.search(startLngLat, endLngLat, opts, function (status, result) {
        console.log(status);
        console.log(startLngLat);
        result.routes[0].steps.forEach(function(item){
        lineArr.push(...item.path)
        });
        });
        
        });

      function startAnimation(){
          marker.moveAlong(lineArr,{duration:200,})};







         
    </script>
</body>
</html>